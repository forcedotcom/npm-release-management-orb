# Copyright (c) 2018, salesforce.com, inc.
# All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause
# For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/BSD-3-Clause

# How to author commands: https://circleci.com/docs/2.0/reusing-config/#authoring-reusable-commands
description: >
  Verify that signed npm package is publicly available using @salesforce/sfdx-trust

steps:
  - jq/install
  - run:
      name: Verify signed npm package
      command: |
        PKG_NAME=$(cat package.json | jq -r .name)
        PKG_VERSION=$(cat package.json | jq -r .version)
        sfdx-trust plugins:trust:verify --npm $PKG_NAME@$PKG_VERSION --json
