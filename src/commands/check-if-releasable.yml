# Copyright (c) 2018, salesforce.com, inc.
# All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause
# For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/BSD-3-Clause

# How to author commands: https://circleci.com/docs/2.0/reusing-config/#authoring-reusable-commands
description: >
  Determine if a release is necessary. Runs sfdx npm:release:validate, which returns a true if a release is needed.
  Command will set env var NEEDS_RELEASE accordingly

steps:
  - run:
      name: Release validate
      command: |
        NEEDS_RELEASE=$(sf-release npm:release:validate)
        echo "Release Needed:${NEEDS_RELEASE}"
        echo 'export NEEDS_RELEASE="${NEEDS_RELEASE}"' >> $BASH_ENV
